# ЁЯРЫ Debug Guide: р╕Ыр╕▒р╕Нр╕лр╕▓р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Др╕бр╣Ир╕Вр╕╢р╣Йр╕Щр╕лр╕ер╕▒р╕Зр╕Хр╕нр╕Ър╕гр╕▒р╕Ър╕Др╕│р╕Вр╕нр╕Ьр╕╣р╣Йр╕Фр╕╣р╣Бр╕е

## ЁЯУЛ р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ

### 1. р╣Ар╕Ыр╕┤р╕Ф Browser Console (F12)
- р╕Бр╕Ф F12 р╕лр╕гр╕╖р╕нр╕Др╕ер╕┤р╕Бр╕Вр╕зр╕▓ тЖТ Inspect
- р╣Др╕Ыр╕Чр╕╡р╣Ир╣Бр╕Чр╣Зр╕Ъ "Console"
- р╣Ар╕ер╕╖р╕нр╕Б "Preserve log" р╣Ар╕Юр╕╖р╣Ир╕нр╣Ар╕Бр╣Зр╕Ъ logs р╣Др╕зр╣Й

### 2. р╕Хр╕нр╕Ър╕гр╕▒р╕Ър╕Др╕│р╕Вр╕нр╣Бр╕ер╕░р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Logs

р╕лр╕ер╕▒р╕Зр╕Ир╕▓р╕Бр╕Хр╕нр╕Ър╕гр╕▒р╕Ър╕Др╕│р╕Вр╕н р╕Др╕╕р╕Ур╕Др╕зр╕гр╣Ар╕лр╣Зр╕Щ logs р╕Хр╕▓р╕бр╕ер╕│р╕Фр╕▒р╕Ър╕Фр╕▒р╕Зр╕Щр╕╡р╣Й:

#### тЬЕ Logs р╕Чр╕╡р╣Ир╕Др╕зр╕гр╣Ар╕лр╣Зр╕Щ (р╕Хр╕▓р╕бр╕ер╕│р╕Фр╕▒р╕Ъ):

```
ЁЯФД Refreshing user data after accepting invitation...
тЬЕ Navigating to dashboard...

ЁЯФН Loading managed shops for user: [USER_ID]
ЁЯУЛ Managed shops: [SHOP_OWNER_ID]
ЁЯСд User role: [ROLE]
тЬЕ User is shop manager, using shop owner ID: [SHOP_OWNER_ID]
ЁЯПк Total managed shops: 1
ЁЯОп Final currentShopOwnerId set to: [SHOP_OWNER_ID]

ЁЯФД Dashboard: р╕Бр╕│р╕ер╕▒р╕Зр╣Вр╕лр╕ер╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕е...
ЁЯФС Dashboard: Using owner ID: [SHOP_OWNER_ID]
ЁЯСд Dashboard: Current user ID: [USER_ID]
ЁЯПк Dashboard: Current shop owner ID: [SHOP_OWNER_ID]
```

### 3. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Ыр╕▒р╕Нр╕лр╕▓

#### тЭМ р╕Ыр╕▒р╕Нр╕лр╕▓р╕Чр╕╡р╣И 1: managedShops р╣Ар╕Ыр╣Зр╕Щ array р╕зр╣Ир╕▓р╕З
```
ЁЯУЛ Managed shops: []
тЪая╕П User has no shop, using own ID as fallback
```

**р╕кр╕▓р╣Ар╕лр╕Хр╕╕:** р╕Вр╣Йр╕нр╕бр╕╣р╕е shopMembers р╣Др╕бр╣Ир╕Цр╕╣р╕Бр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕ер╕З Firestore

**р╕зр╕┤р╕Шр╕╡р╣Бр╕Бр╣Й:**
1. р╣Ар╕Ыр╕┤р╕Ф Firebase Console тЖТ Firestore Database
2. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ collection `shopMembers`
3. р╕Др╕зр╕гр╕бр╕╡ document р╕Чр╕╡р╣Ир╕бр╕╡:
   - `shopOwnerId`: ID р╕Вр╕нр╕Зр╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕Зр╕гр╣Йр╕▓р╕Щ
   - `memberId`: ID р╕Вр╕нр╕Зр╕Др╕╕р╕У
   - `memberEmail`: Email р╕Вр╕нр╕Зр╕Др╕╕р╕У

р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╕бр╕╡ тЖТ р╕ер╕нр╕Зр╕кр╣Ир╕Зр╕Др╕│р╕Вр╕нр╣Гр╕лр╕бр╣Ир╣Бр╕ер╕░р╕Хр╕нр╕Ър╕гр╕▒р╕Ър╕нр╕╡р╕Бр╕Др╕гр╕▒р╣Йр╕З

#### тЭМ р╕Ыр╕▒р╕Нр╕лр╕▓р╕Чр╕╡р╣И 2: currentShopOwnerId р╣Ар╕Ыр╣Зр╕Щ null
```
ЁЯПк Dashboard: Current shop owner ID: null
```

**р╕кр╕▓р╣Ар╕лр╕Хр╕╕:** AuthContext р╕вр╕▒р╕Зр╣Др╕бр╣Ир╕Чр╕▒р╕Щр╣Вр╕лр╕ер╕Ф

**р╕зр╕┤р╕Шр╕╡р╣Бр╕Бр╣Й:**
1. р╕гр╕нр╕кр╕▒р╕Б 2-3 р╕зр╕┤р╕Щр╕▓р╕Чр╕╡
2. Refresh р╕лр╕Щр╣Йр╕▓ (F5)
3. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ logs р╕нр╕╡р╕Бр╕Др╕гр╕▒р╣Йр╕З

#### тЭМ р╕Ыр╕▒р╕Нр╕лр╕▓р╕Чр╕╡р╣И 3: Loading games р╣Бр╕Хр╣Ир╣Др╕Фр╣Й 0 games
```
ЁЯУК Games: Loaded 0 games
```

**р╕кр╕▓р╣Ар╕лр╕Хр╕╕:** р╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕Зр╕гр╣Йр╕▓р╕Щр╕вр╕▒р╕Зр╣Др╕бр╣Ир╕бр╕╡р╣Ар╕Бр╕б р╕лр╕гр╕╖р╕н query р╕Ьр╕┤р╕Ф

**р╕зр╕┤р╕Шр╕╡р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ:**
1. р╣Ар╕Ыр╕┤р╕Ф Firestore тЖТ collection `games`
2. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕бр╕╡ document р╕Чр╕╡р╣И `ownerId` р╕Хр╕гр╕Зр╕Бр╕▒р╕Ъ `currentShopOwnerId` р╕лр╕гр╕╖р╕нр╣Др╕бр╣И
3. р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╕бр╕╡ тЖТ р╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕Зр╕гр╣Йр╕▓р╕Щр╕Хр╣Йр╕нр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Ар╕Бр╕бр╕Бр╣Ир╕нр╕Щ

### 4. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕лр╕Щр╣Йр╕▓р╕Хр╣Ир╕▓р╕Зр╣Ж

#### Dashboard (/)
р╕Др╕╕р╕Ур╕Др╕зр╕гр╣Ар╕лр╣Зр╕Щ:
- тЬЕ р╕кр╕Цр╕┤р╕Хр╕┤р╕вр╕нр╕Фр╕Вр╕▓р╕в
- тЬЕ р╕Бр╕гр╕▓р╕Яр╕гр╕▓р╕вр╕зр╕▒р╕Щ
- тЬЕ р╕вр╕нр╕Фр╕Вр╕▓р╕вр╕ер╣Ир╕▓р╕кр╕╕р╕Ф
- тЬЕ р╕Ир╕│р╕Щр╕зр╕Щр╣Ар╕Бр╕б

#### р╣Ар╕Бр╕б (/games)
р╕Др╕╕р╕Ур╕Др╕зр╕гр╣Ар╕лр╣Зр╕Щ:
- тЬЕ р╕гр╕▓р╕вр╕Бр╕▓р╕гр╣Ар╕Бр╕бр╕Вр╕нр╕Зр╕гр╣Йр╕▓р╕Щ
- тЬЕ р╕Ыр╕╕р╣Ир╕бр╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Бр╕б (р╕Цр╣Йр╕▓р╕бр╕╡р╕кр╕┤р╕Чр╕Шр╕┤р╣М)

#### р╕вр╕нр╕Фр╕Вр╕▓р╕в (/sales)
р╕Др╕╕р╕Ур╕Др╕зр╕гр╣Ар╕лр╣Зр╕Щ:
- тЬЕ р╕гр╕▓р╕вр╕Бр╕▓р╕гр╕вр╕нр╕Фр╕Вр╕▓р╕в
- тЬЕ р╕кр╕Цр╕┤р╕Хр╕┤р╕вр╕нр╕Фр╕Вр╕▓р╕вр╕зр╕▒р╕Щр╕Щр╕╡р╣Й
- тЬЕ р╕Ыр╕╕р╣Ир╕бр╣Ар╕Юр╕┤р╣Ир╕бр╕вр╕нр╕Фр╕Вр╕▓р╕в

## ЁЯФз р╕зр╕┤р╕Шр╕╡р╣Бр╕Бр╣Йр╕Ыр╕▒р╕Нр╕лр╕▓р╕Чр╕▒р╣Ир╕зр╣Др╕Ы

### р╕зр╕┤р╕Шр╕╡р╕Чр╕╡р╣И 1: Hard Refresh
1. р╕Бр╕Ф `Ctrl + Shift + R` (Windows) р╕лр╕гр╕╖р╕н `Cmd + Shift + R` (Mac)
2. р╕гр╕нр╣Гр╕лр╣Йр╕лр╕Щр╣Йр╕▓р╣Вр╕лр╕ер╕Фр╣Гр╕лр╕бр╣И
3. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ console logs

### р╕зр╕┤р╕Шр╕╡р╕Чр╕╡р╣И 2: р╕ер╣Йр╕▓р╕З Cache
1. р╕Бр╕Ф F12 тЖТ р╣Бр╕Чр╣Зр╕Ъ Application
2. р╕Вр╕вр╕▓р╕в "Storage" тЖТ р╕Др╕ер╕┤р╕Б "Clear site data"
3. Refresh р╕лр╕Щр╣Йр╕▓ (F5)
4. Login р╣Гр╕лр╕бр╣И

### р╕зр╕┤р╕Шр╕╡р╕Чр╕╡р╣И 3: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Firestore Rules
```javascript
// р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕бр╕╡ rules р╕кр╕│р╕лр╕гр╕▒р╕Ъ shopMembers
match /shopMembers/{memberId} {
  allow read: if request.auth != null;
  allow write: if request.auth != null;
}
```

### р╕зр╕┤р╕Шр╕╡р╕Чр╕╡р╣И 4: р╕ер╕Ър╣Бр╕ер╕░р╕кр╕гр╣Йр╕▓р╕Зр╣Гр╕лр╕бр╣И
1. р╣Гр╕лр╣Йр╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕Зр╕гр╣Йр╕▓р╕Щр╕ер╕Ър╕Др╕╕р╕Ур╕нр╕нр╕Бр╕Ир╕▓р╕Бр╕Ьр╕╣р╣Йр╕Фр╕╣р╣Бр╕е (р╣Гр╕Щр╕лр╕Щр╣Йр╕▓ Profile)
2. р╕кр╣Ир╕Зр╕Др╕│р╕Вр╕нр╣Гр╕лр╕бр╣И
3. р╕гр╕н 5 р╕зр╕┤р╕Щр╕▓р╕Чр╕╡
4. р╕Хр╕нр╕Ър╕гр╕▒р╕Ър╕Др╕│р╕Вр╕нр╣Гр╕лр╕бр╣И
5. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ console logs

## ЁЯУК р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З Console Logs р╕Чр╕╡р╣Ир╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З

```
// 1. р╕лр╕ер╕▒р╕Зр╕Ир╕▓р╕Бр╕Хр╕нр╕Ър╕гр╕▒р╕Ър╕Др╕│р╕Вр╕н
тЬЕ р╕Хр╕нр╕Ър╕гр╕▒р╕Ър╕Др╕│р╕Вр╕нр╕кр╕│р╣Ар╕гр╣Зр╕И! р╕Бр╕│р╕ер╕▒р╕Зр╣Вр╕лр╕ер╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕гр╣Йр╕▓р╕Щ...
ЁЯФД Refreshing user data after accepting invitation...
тЬЕ Navigating to dashboard...

// 2. р╣Вр╕лр╕ер╕Ф managed shops
ЁЯФН Loading managed shops for user: abc123xyz
ЁЯУЛ Managed shops: ["xyz789abc"]
ЁЯСд User role: seller
тЬЕ User is shop manager, using shop owner ID: xyz789abc
ЁЯПк Total managed shops: 1
ЁЯОп Final currentShopOwnerId set to: xyz789abc

// 3. Dashboard р╣Вр╕лр╕ер╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕е
ЁЯФД Dashboard: р╕Бр╕│р╕ер╕▒р╕Зр╣Вр╕лр╕ер╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕е...
ЁЯФС Dashboard: Using owner ID: xyz789abc
ЁЯСд Dashboard: Current user ID: abc123xyz
ЁЯПк Dashboard: Current shop owner ID: xyz789abc
тЬЕ Dashboard: р╣Вр╕лр╕ер╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕кр╕гр╣Зр╕Ир╕кр╕┤р╣Йр╕Щ

// 4. Games р╣Вр╕лр╕ер╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕е
ЁЯФД Games: Loading games...
ЁЯСд Games: User ID: abc123xyz
ЁЯПк Games: Current shop owner ID: xyz789abc
ЁЯФТ Games: Is admin: false
тЬЕ Games: Loading games for shop owner: xyz789abc
ЁЯУК Games: Loaded 5 games
```

## ЁЯЖШ р╕вр╕▒р╕Зр╣Бр╕Бр╣Йр╣Др╕бр╣Ир╣Др╕Фр╣Й?

р╕кр╣Ир╕З screenshot р╕Вр╕нр╕З Console logs р╕бр╕▓р╕Чр╕╡р╣И:
1. Screenshot р╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╕Хр╕▒р╣Йр╕Зр╣Бр╕Хр╣Ир╕Хр╕нр╕Ър╕гр╕▒р╕Ър╕Др╕│р╕Вр╕нр╕Ир╕Щр╕Цр╕╢р╕Зр╕лр╕Щр╣Йр╕▓ Dashboard
2. Screenshot Firestore collection `shopMembers`
3. Screenshot Firestore collection `games` (р╕Вр╕нр╕Зр╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕Зр╕гр╣Йр╕▓р╕Щ)

## ЁЯУЭ Checklist

- [ ] р╣Ар╕Ыр╕┤р╕Ф Console (F12) р╣Бр╕ер╕░р╣Ар╕ер╕╖р╕нр╕Б "Preserve log"
- [ ] р╕Хр╕нр╕Ър╕гр╕▒р╕Ър╕Др╕│р╕Вр╕нр╣Бр╕ер╕░р╕Фр╕╣ logs
- [ ] р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕бр╕╡ "ЁЯУЛ Managed shops" р╕Чр╕╡р╣Ир╣Др╕бр╣Ир╣Гр╕Кр╣И array р╕зр╣Ир╕▓р╕З
- [ ] р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ "ЁЯПк Current shop owner ID" р╣Др╕бр╣Ир╣Ар╕Ыр╣Зр╕Щ null
- [ ] р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ Dashboard р╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е
- [ ] р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕лр╕Щр╣Йр╕▓ Games р╣Бр╕кр╕Фр╕Зр╣Ар╕Бр╕бр╕Вр╕нр╕Зр╕гр╣Йр╕▓р╕Щ
- [ ] р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕лр╕Щр╣Йр╕▓ Sales р╣Бр╕кр╕Фр╕Зр╕вр╕нр╕Фр╕Вр╕▓р╕в

---

**Version:** 1.0.1  
**Last Updated:** 2025-01-XX

